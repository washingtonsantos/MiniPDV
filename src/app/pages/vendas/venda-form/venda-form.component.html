<div class="container">
    <div class="row">
        <!-- OPÇÕES -->
        <div class="col">

            <div class="input-group mb-3 mr-2">

                <!-- ESCOLHA CLIENTE #INICIO -->
                <div class="input-group-prepend ml-2">
                    <span
                        class="input-group-text"
                        id="basic-addon1"
                        class="form-control basicAutoSelect"
                        autocomplete="off"
                    >
                        Cliente
                    </span>
                </div>
                <ng-select
                    style="width: 250px;"
                    [items]="clientes"
                    [virtualScroll]="true"
                    bindLabel="nome"
                    placeholder="Selecione o cliente"
                    [(ngModel)]="cliente"
                    [searchFn]="getCliente()"
                >
                    <ng-template
                        ng-option-tmp
                        let-item="item"
                        let-index="index"
                    >
                        <div>{{ item.id + ' - ' + item.nome }}</div>
                    </ng-template>
                </ng-select>
                <!-- ESCOLHA CLIENTE #FIM -->

                <!-- ESCOLHA VENDEDOR #INICIO -->
                <div class="input-group-prepend ml-2">
                    <span
                        class="input-group-text"
                        id="basic-addon1"
                        class="form-control basicAutoSelect"
                        autocomplete="off"
                    >
                        Vendedor
                    </span>
                </div>
                <ng-select
                    style="width: 250px;"
                    [items]="vendedores"
                    [virtualScroll]="true"
                    bindLabel="nome"
                    placeholder="Selecione o vendedor"
                    [(ngModel)]="vendedor"
                    [searchFn]="getCliente"
                >
                    <ng-template
                        ng-option-tmp
                        let-item="item"
                        let-index="index"
                    >
                        <div>{{ item.id + ' - ' + item.nome }}</div>
                    </ng-template>
                </ng-select>
                <!-- ESCOLHA VENDEDOR #FIM -->

                <!-- ESCOLHA CLIENTE #INICIO -->
                <div class="input-group mb-3 mt-2 ml-2 mr-2">
                    <div class="input-group-prepend">
                        <span
                            class="input-group-text"
                            id="basic-addon3"
                        >
                            Buscar clientes
                        </span>
                    </div>
                    <input
                        type="text"
                        placeholder="Pesquise por código ou descrição do produto"
                        [(ngModel)]="searchText"
                        class="form-control"
                        id="basic-url"
                        aria-describedby="basic-addon3"
                    >
                </div>
                <!-- ESCOLHA CLIENTE #FIM -->

            </div>

        </div>

    </div>

    <div class="row">

        <div class="col">
            <div class="card shadow">
              <div class="card-header">Produtos</div>
              <div class="card-body">
                <div class="table-responsive">
                  <table
                      class="table"
                      *ngIf="produtos.length > 0 && searchText != ''"
                  >
                      <thead class="thead-dark">
                          <tr>
                              <th scope="col">Código</th>
                              <th scope="col">Descrição</th>
                              <th scope="col">Unidade</th>
                              <th scope="col">Estoque</th>
                              <th scope="col">Preço</th>
                              <th></th>
                          </tr>
                      </thead>
                      <tbody>
                          <tr *ngFor="let produto of produtos | filtroArray: searchText; index as i;">
                              <th style="width: 50px;">{{ produto.id }}</th>
                              <td style="width: 50px;">{{ produto.descricao }}</td>
                              <td style="width: 50px;">{{ produto.unidade }}</td>
                              <td style="width: 50px;">{{ produto.estoque }}</td>
                              <td style="width: 100px;">{{ produto.preco | currency:'R$' }}</td>
                              <td>
                                  <button
                                      class="btn btn-primary"
                                      (click)="addProduto(produto)"
                                  >
                                      +
                                  </button>
                              </td>
                          </tr>
                          <tr>
                          </tr>
                      </tbody>
                  </table>
              </div>
              <div *ngIf="produtos.length === 0 || searchText == ''">Nenhum Produto Encontrado</div>
              </div>
              <div class="card-footer">
              </div>

            </div>
        </div>

        <div class="col">
            <div class="card shadow">
                <div class="card-header">Itens Adicionados</div>
                <div class="card-body">
                    <table
                        class="table"
                        *ngIf="pedidoItens.length > 0"
                    >
                        <thead class="thead-dark">
                            <tr>
                                <th scope="col">Produto</th>
                                <th scope="col">Quantidade</th>
                                <th scope="col">Preço</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of pedidoItens; index as i;">
                                <td>{{ item.produto?.descricao }}</td>
                                <td><input type="text" style="width: 50px;" [(ngModel)]="item.quantidade" (ngModelChange)="editPedidoItem(item)" ></td>
                                <td><input type="text" style="width: 100px;" [(ngModel)]="item.preco" ></td>
                                <!-- <td style="width: 100px;">{{ pedido?.preco | currency:'R$' }}</td> -->
                                <td>
                                    <button class="btn btn-danger" (click)="removerItem(item)">-</button>
                                </td>
                            </tr>
                            <tr>
                            </tr>
                        </tbody>
                    </table>
                    <div *ngIf="pedidoItens.length === 0">Nenhum produto Adicionado</div>
                </div>
                <div class="card-footer">
                  <div  *ngIf="pedidoItens.length > 0 && cliente != null && vendedor != null">
                    <div class="d-flex justify-content-stars">
                      <label>Valor Total R$ {{ valorTotal }}</label>
                    </div>
                    <div class="d-flex justify-content-end">
                      <button
                           class="btn btn-success " (click)="gravarPedido(pedidoItens)"
                         >
                          Gravar
                      </button>
                    </div>
                  </div>
                </div>
            </div>
        </div>

        <!-- <div class="col ml-2 mr-2">
     <div class="card">
      <table class="table" *ngIf="pedidoItens.length > 0">
        <thead class="thead-dark">
          <tr>
            <th scope="col">Produto</th>
            <th scope="col">Quantidade</th>
            <th scope="col">Preço</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let pedido of pedidoItens; index as i;">
            <td>{{ pedido.produto?.descricao }}</td>
            <td>{{ pedido.quantidade }}</td>
            <td style="width: 100px;"> {{ pedido?.preco | currency:'R$' }}</td>
            <td><button class="btn btn-success">-</button></td>
          </tr>
          <tr>

            <div>
              <pre>
                {{ pedidoItens | json }}
              </pre>
            </div>
        </tbody>
      </table>
      <div *ngIf="pedidoItens.length === 0">
        Nenhum produto Adicionado
      </div>
     </div>
   </div> -->

    </div>
</div>
